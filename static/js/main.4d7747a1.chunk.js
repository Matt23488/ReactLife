(this.webpackJsonpreactlife=this.webpackJsonpreactlife||[]).push([[0],{12:function(t,e,i){},13:function(t,e,i){},14:function(t,e,i){},16:function(t,e,i){"use strict";i.r(e);var n=i(3),s=i.n(n),h=i(5),a=i.n(h),r=(i(12),i(13),i(0)),o=i(1),c=i(7),l=i(6),u=function(){function t(e,i,n,s){Object(r.a)(this,t),this.corner=void 0,this.width=void 0,this.height=void 0,"number"===typeof e?(this.corner={x:e,y:i},this.width=n,this.height=s):(this.corner=e,this.width=i,this.height=n)}return Object(o.a)(t,[{key:"x",get:function(){return this.corner.x}},{key:"y",get:function(){return this.corner.y}}]),t}(),_=function(){function t(e,i,n){Object(r.a)(this,t),this._width=void 0,this._height=void 0,this._bytes=void 0,this._width=e,this._height=i,this._bytes=n||new Uint8Array(e*i)}return Object(o.a)(t,[{key:"isValid",value:function(t,e){return 0<=t&&t<this._width&&0<=e&&e<this._height}},{key:"get",value:function(t,e){if(!this.isValid(t,e))throw new Error("ByteBlock get(): Out of range");return this._bytes[e*this._width+t]}},{key:"set",value:function(t,e,i){if(!this.isValid(t,e))throw new Error("ByteBlock set(): Out of range");this._bytes[e*this._width+t]=i}},{key:"moveLeft",value:function(){for(var e=new Uint8Array(this._bytes.length),i=1;i<e.length;i++)e[i-1]=this._bytes[i];for(var n=this._width-1;n<e.length;n+=this._width)e[n]=0;return new t(this._width,this._height,e)}},{key:"moveRight",value:function(){for(var e=new Uint8Array(this._bytes.length),i=1;i<e.length;i++)e[i]=this._bytes[i-1];for(var n=this._width;n<e.length;n+=this._width)e[n]=0;return new t(this._width,this._height,e)}},{key:"moveUp",value:function(){for(var e=new Uint8Array(this._bytes.length),i=0;i<e.length-this._width;i++)e[i]=this._bytes[i+this._width];return new t(this._width,this._height,e)}},{key:"moveDown",value:function(){for(var e=new Uint8Array(this._bytes.length),i=0;i<e.length-this._width;i++)e[i+this._width]=this._bytes[i];return new t(this._width,this._height,e)}},{key:"where",value:function(e){for(var i=new Uint8Array(this._bytes.length),n=0;n<i.length;n++)i[n]=this._bytes[n]===e?1:0;return new t(this._width,this._height,i)}},{key:"sum",value:function(){for(var e=this,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];if(n.some((function(t){return t._width!==e._width||t._height!==e._height})))throw new Error("ByteBlock sum(): Incompatible ByteBlocks");for(var h=this._bytes.map((function(t){return t})),a=0,r=n;a<r.length;a++)for(var o=r[a],c=0;c<h.length;c++)h[c]+=o._bytes[c];return new t(this._width,this._height,h)}}],[{key:"or",value:function(e,i){if(e._width!==i._width||e._height!==i._height)throw new Error("ByteBlock or(): Incompatible ByteBlocks");for(var n=new Uint8Array(e._bytes.length),s=0;s<n.length;s++)n[s]=e._bytes[s]|i._bytes[s];return new t(e._width,e._height,n)}},{key:"and",value:function(e,i){if(e._width!==i._width||e._height!==i._height)throw new Error("ByteBlock and(): Incompatible ByteBlocks");for(var n=new Uint8Array(e._bytes.length),s=0;s<n.length;s++)n[s]=e._bytes[s]&i._bytes[s];return new t(e._width,e._height,n)}}]),t}(),d=function(){function t(){Object(r.a)(this,t),this._width=256,this._height=256,this._cells=new _(this._width,this._height)}return Object(o.a)(t,[{key:"clear",value:function(){this._cells=new _(this._width,this._height)}},{key:"isValidPoint",value:function(t,e){return 0<t&&t<this._width-1&&0<e&&e<this._height-1}},{key:"get",value:function(t,e){return!!this.isValidPoint(t,e)&&1===this._cells.get(t,e)}},{key:"set",value:function(t,e,i){this.isValidPoint(t,e)&&this._cells.set(t,e,i?1:0)}},{key:"step",value:function(){var t=this._cells.moveLeft(),e=this._cells.moveRight(),i=this._cells.moveUp(),n=this._cells.moveDown(),s=t.moveUp(),h=e.moveUp(),a=t.moveDown(),r=e.moveDown(),o=this._cells.sum(t,e,i,n,s,h,a,r),c=o.where(3),l=o.where(4),u=_.and(l,this._cells);this._cells=_.or(c,u)}},{key:"draw",value:function(t,e){for(var i=Math.max(0,t.x),n=Math.min(this._width,t.x+t.width),s=Math.max(0,t.y-t.height+1),h=Math.min(this._height,t.y+1),a=s;a<h;a++)for(var r=i;r<n;r++)1===this._cells.get(r,a)&&e({x:r,y:a})}}]),t}();var f="#909";var y=function(){function t(e){Object(r.a)(this,t),this._doLoop=!0,this._canvas=void 0,this._maxScale=0,this._minScale=-6,this._scale=void 0,this._gridScale=void 0,this._corner=void 0,this._life=void 0,this._prevTime=0,this._dragging=!1,this._dragStart={x:-1,y:-1},this._canvas=document.getElementById(e),this._scale=-1,this._gridScale=-3,this._corner={x:-2,y:this.lifeHeight-2},this._life=new d,function(t,e){var i=e.x,n=e.y;t.set(i+1,n+0,!0),t.set(i+2,n+0,!0),t.set(i+0,n-1,!0),t.set(i+1,n-1,!0),t.set(i+1,n-2,!0)}(this._life,{x:128,y:128}),window.addEventListener("resize",this.onWindowResize.bind(this)),this._canvas.addEventListener("wheel",this.onScroll.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this)),this._canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this._canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this._canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),this.onWindowResize(),this.start()}return Object(o.a)(t,[{key:"start",value:function(){this._doLoop=!0,window.requestAnimationFrame(this.loop.bind(this))}},{key:"stop",value:function(){this._doLoop=!1}},{key:"onWindowResize",value:function(){this._canvas.width=window.innerWidth,this._canvas.height=window.innerHeight,this._corner={x:-2,y:this.lifeHeight-2}}},{key:"onKeyDown",value:function(t){switch(t.key){case"s":this.screenshot();break;case" ":this._doLoop?this.stop():this.start()}}},{key:"onScroll",value:function(t){var e=this.bitmapToLife(t);t.deltaY<0?this.zoomIn(e):t.deltaY>0&&this.zoomOut(e)}},{key:"onMouseDown",value:function(t){this._dragging=!0,this._dragStart=this.bitmapToLife({x:t.clientX,y:t.clientY})}},{key:"onMouseMove",value:function(t){if(this._dragging){var e=this.bitmapToLife({x:t.clientX,y:t.clientY});this._corner={x:this._corner.x+this._dragStart.x-e.x,y:this._corner.y+this._dragStart.y-e.y},this.drawDisplay()}}},{key:"onMouseUp",value:function(t){this._dragging=!1}},{key:"loop",value:function(t){var e=t-this._prevTime;this._life.step(),e>=29.999999999999996&&(this.draw(),this._prevTime=t),this._doLoop&&window.requestAnimationFrame(this.loop.bind(this))}},{key:"draw",value:function(){this.drawDisplay()}},{key:"clearDisplay",value:function(){var t=this.ctx,e=this.width,i=this.height;t.fillStyle="#333",t.fillRect(0,0,e,i)}},{key:"drawDisplay",value:function(){this.clearDisplay(),this._scale<0?this.drawBlocks():this.drawPixels()}},{key:"drawGrid",value:function(){if(this.gridEnabled){var t=this.ctx,e=this.width,i=this.height;t.strokeStyle="#000",t.beginPath();for(var n=0;n<e;n+=1<<-this._scale)t.moveTo(n,0),t.lineTo(n,i-1);for(var s=0;s<i;s+=1<<-this._scale)t.moveTo(0,s),t.lineTo(e-1,s);t.closePath(),t.stroke()}}},{key:"drawBlocks",value:function(){var t=this,e=this.ctx;e.fillStyle=f;this._life.draw(this.lifeRect,(function(i){var n=t.lifeToBitmap(i);t.isValidBitmapPoint(n)&&e.fillRect(n.x,n.y,1<<-t._scale,1<<-t._scale)})),this.drawGrid()}},{key:"drawPixels",value:function(){var t=this,e=this.ctx,i=this.width,n=this.height,s=e.getImageData(0,0,i,n),h=function(t){var e=t.slice(1),i=[];if(3===e.length)for(var n=0;n<3;n++)i.push(Number("0x".concat(e.charAt(n).repeat(2))));else for(var s=0;s<6;s+=2)i.push(Number("0x".concat(e.slice(s,s+2))));return i}(f);this._life.draw(this.lifeRect,(function(e){var n=t.lifeToBitmap(e);s.data[n.y*i*4+4*n.x+0]=h[0],s.data[n.y*i*4+4*n.x+1]=h[1],s.data[n.y*i*4+4*n.x+2]=h[2],s.data[n.y*i*4+4*n.x+3]=255})),e.putImageData(s,0,0)}},{key:"screenshot",value:function(){var t=this._canvas.toDataURL("image/png").replace(/^data:image\/[^;]/,"data:application/octet-stream"),e=document.createElement("a");e.setAttribute("download","Life.png"),e.setAttribute("href",t),e.click()}},{key:"zoomOut",value:function(t){this._scale<this._maxScale&&(this._corner={x:2*this._corner.x-t.x,y:2*this._corner.y-t.y},this._scale++,this.drawDisplay())}},{key:"zoomIn",value:function(t){this._scale>this._minScale&&(this._corner={x:Math.floor((this._corner.x+t.x)/2),y:Math.floor((this._corner.y+t.y)/2)},this._scale--,this.drawDisplay())}},{key:"canvas",get:function(){return this._canvas}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t}},{key:"gridScale",get:function(){return this._gridScale}},{key:"corner",get:function(){return this._corner},set:function(t){this._corner=t}},{key:"life",get:function(){return this._life}},{key:"ctx",get:function(){return this._canvas.getContext("2d")}},{key:"width",get:function(){return this._canvas.width}},{key:"height",get:function(){return this._canvas.height}},{key:"scaleUp",value:function(t){return this._scale>=0?t<<this._scale:t>>-this._scale}},{key:"scaleDown",value:function(t){return this._scale>=0?t>>this._scale:t<<-this._scale}},{key:"lifeWidth",get:function(){return this.scaleUp(this._canvas.width)}},{key:"lifeHeight",get:function(){return this.scaleUp(this._canvas.height)}},{key:"lifeRect",get:function(){return new u(this._corner,this.lifeWidth,this.lifeHeight)}},{key:"lifeToBitmap",value:function(t){return{x:this.scaleDown(t.x-this._corner.x),y:this.scaleDown(this._corner.y-t.y)}}},{key:"bitmapToLife",value:function(t){return{x:this._corner.x+this.scaleUp(t.x),y:this._corner.y-this.scaleUp(t.y)}}},{key:"gridEnabled",get:function(){return this._scale<=this._gridScale}},{key:"isValidBitmapPoint",value:function(t){return 0<=t.x&&t.x<this._canvas.width&&0<=t.y&&t.y<this._canvas.height}}]),t}(),v=(i(14),i(2)),w=function(t){Object(c.a)(i,t);var e=Object(l.a)(i);function i(){return Object(r.a)(this,i),e.apply(this,arguments)}return Object(o.a)(i,[{key:"componentDidMount",value:function(){var t=new y("lifeCanvas");this.setState({lifeData:t})}},{key:"componentWillUnmount",value:function(){var t;null===(t=this.state.lifeData)||void 0===t||t.stop()}},{key:"render",value:function(){return Object(v.jsx)("canvas",{className:"Life",id:"lifeCanvas"})}}]),i}(s.a.Component);var g=function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(w,{})})},k=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,17)).then((function(e){var i=e.getCLS,n=e.getFID,s=e.getFCP,h=e.getLCP,a=e.getTTFB;i(t),n(t),s(t),h(t),a(t)}))};a.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(g,{})}),document.getElementById("root")),k()}},[[16,1,2]]]);
//# sourceMappingURL=main.4d7747a1.chunk.js.map